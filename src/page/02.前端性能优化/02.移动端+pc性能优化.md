<!--
 * @Description:移动端性能优化
 * @Author: xiao.zhang
 * @Date: 2020-10-26 14:46:24
 * @LastEditors: xiao.zhang
 * @LastEditTime: 2020-11-12 18:23:24
-->

![](https://tva1.sinaimg.cn/large/0081Kckwgy1gkc16bq2kcj30go0j0tap.jpg)
网络加载类：

## 首屏加载优化

背景：
首屏加速，到底是要加速什么? 答案可能很简单：加快网页的展现过程。不过再细想一下，网页快不快是针对用户而言的，那么什么样的速度会让用户感到快呢？或者说，哪些指标能够衡量用户所感知的"快"呢？

##### 1，首屏性能指标细化：

- FP（first paint）：浏览器开始请求网页到网页首帧绘制的时间点
- FCP(first contentful paint):浏览器渲染来自 DOM 第一位内容的时间点
- FMP(first meanungful paint)：首次有效绘制。这是一个很主观的指标。根据业务的不同，每一个网站的有效内容都是不相同的，有效内容就是网页中"主角元素"。对于视频网站而言，主角元素就是视频。对于搜索引擎而言，主角元素就是搜索框。
- TTI(time to interactive)：可交互时间。用于标记应用已进行视觉渲染并能可靠响应用户输入的时间点。应用可能会因为多种原因而无法响应用户输入：① 页面组件运行所需的 JavaScript 尚未加载完成。② 耗时较长的任务阻塞主线程

##### 2，首屏性能加载优化方案：

1，使用 svg（矢量图）:

- 适用：小 logo，使用 XML 文档描述来绘图。很容易编辑，只要增加或移除相应的元素就可以了
- canvas：主要针对复杂的动画

2，首屏加载性能优化：

- 使用骨架屏
- 使用 webp
- 减少 http 请求

## 按需加载优化（需要的时候才会去加载相应的 js）(按需加载会导致大量重绘，影响渲染性能)

##### 1，懒加载

##### 2，滚屏加载

##### 3，Media Query 加载

## 渲染优化

1，设置 viewport：HTML 的 viewport 可加速页面的渲染

## 面试回答：

- 1、从输入 URL 到最终的网页显示，涉及到网络层面的，主要有三个过程，DNS 解析、TCP 连接，HTTP 请求/响应，
- 2、DNS 解析、TCP 连接，前端可做的事情，是比较少的，主要是服务端和运维层面的事情，例如，智能 DNS 解析，减少 DNS 查询，提供访问速度最快的 IP 地址回来
- 3、HTTP 的请求/响应优化，才是前端性能优化的核心，主要分两个大的方面：减少请求次数、降低单次请求时间
- 4、合理利用 HTTP 缓存（强缓存、协商缓存）
- 5、CDN 降低网络拥塞、就近访问
- 6、避免重定向
- 7、图片优化（需要 UI 帮助）、图片懒加载、雪碧图
- 8、脚本放底部避免 js 阻塞、使用外部 js/css 文件/字体图标等
- 9、渲染优化：css 选择器的合理使用、尽量重绘减少重排、减少 dom 操作
- 10、尽量重绘，减少重排:
- 11、Dom 变量操作完之后，尽量缓存；
- 12、在循环中操作字符串，最后再操作 dom;
- 13、使用文档碎片 documentFrament；
- 14、不要将尺寸和位置的读与写放在一个语句里面；
- 15、样式如果是重排得到的，尽量缓存，避免再次重排；
- 16、不要直接修改 style，而是通过 class 一次性改变；
- 17、requestAnimationFrame 的使用；
- 18、某些场景下，用 visible:hidden 代替 display:none；

###### 19、事件的优化：

- 1、避免事件多次绑定，页面卸载的时候，解除事件的绑定等；
- 2、可以使用事件委托，避免循环给每个元素绑定事件；
- 3、频繁触发的事件，注意使用节流与防抖（）

- 20、长列表渲染：
- 21、少用 iframe(会阻塞页面加载)
- 22、在 IE 中用@import 与在底部用<link>效果一样，所以最好不要用它

###### 23、首屏优化：

- 1、gzip 压缩、css 压缩、js 压缩、图片压缩
- 2、路由懒加载，主 js 切割、treeShaking
- 3、css 前置
- 4、js 后置，尽量不要首屏放置 js 内联脚本
- 5、首屏同步渲染 html，后续的滚屏再采用异步请求数据和渲染 html
- 6、首屏服务端渲染

## 名词解释：

- 路由懒加载：webpack 编译打包，将每个路由组件的代码分割成一个个 js 文件，初识时不会记载这些 js 文件，只有当激活路由组件才会去加载相应的 js 文件
- treeShaking：去除那些引用的，但没有使用的代码
